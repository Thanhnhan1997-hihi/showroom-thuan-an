<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Th√™m Bootstrap t·ª´ th∆∞ m·ª•c c·ª•c b·ªô -->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- Th√™m Axios t·ª´ th∆∞ m·ª•c c·ª•c b·ªô -->
    <script src="js/axios.min.js"></script>

    <!-- Th√™m Bootstrap JS t·ª´ th∆∞ m·ª•c c·ª•c b·ªô -->
    <script src="js/bootstrap.bundle.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh S√°ch ƒê∆°n H√†ng BaÃÅn Xe</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            font-family:'Montserrat', sans-serif;
            background: url('https://vinfastotominhdao.vn/wp-content/uploads/vf7-trang.jpg') no-repeat center center fixed;
            background-size: cover;
            color: #f8f9fa;
            padding: 20px;
        }
        .container {
            max-width: 1550px;
            margin: auto;
            background: rgba(181, 181, 181, 0.85);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(1px);
        }

.nav-tabs .nav-link {
    color: white;
    background: #222; /* M√†u m·∫∑c ƒë·ªãnh c·ªßa tab ch∆∞a ch·ªçn */
    border-radius: 8px 8px 0 0;
    border: 2px solid transparent;
    transition: all 0.3s ease-in-out;
}

.nav-tabs .nav-link.active {
    background: linear-gradient(45deg, #333333, #333300); /* Gradient v√†ng cam */
    color: black; /* Ch·ªØ m√†u ƒëen ƒë·ªÉ t∆∞∆°ng ph·∫£n */
    font-weight: bold;
    border: 2px solid #FFFFFF; /* Vi·ªÅn v√†ng */
    box-shadow: 0 4px 10px rgba(255, 204, 0, 0.5); /* Hi·ªáu ·ª©ng ƒë·ªï b√≥ng */

        }
        .tab-content {
            background: rgba(36, 36, 36, 0.9);
            padding: 20px;
            border-radius: 8px;
        }
        td {
            font-size: 10px;
            padding: 5px;
        }
#table1 tbody tr:hover, 
#table2 tbody tr:hover {
    background-color: #ff8800 !important;
    color: white;
    transition: background-color 0.15s ease-in-out;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

tbody tr {
    animation: fadeIn 0.5s ease-in-out;
}
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            padding: 40px 0;
            font-size: 25px;
            font-weight: bold;
            background: linear-gradient(45deg, rgba(68, 68, 68, 0.85), rgba(34, 34, 34, 0.85));
            backdrop-filter: blur(5px);
            color: #fff;
            border-radius: 12px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.1);
            animation: fadeIn 5s ease-in-out;
        }
        .table-responsive {
            max-height: 500px;
            overflow-y: auto;
            border-radius: 8px;
        }
        th {
            white-space: nowrap;
            background: linear-gradient(45deg, #444444, #222222);
            color: white;
            font-size: 15px;
            text-transform: uppercase;
            padding: 14px;
            text-align: center;
            font-weight: bold;
            border-bottom: 3px solid #ffcc00;
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 10;
        }
tbody tr:hover {
    background-color: rgba(255, 204, 0, 0.2) !important;
    color: white;
    transform: scale(1.01);
}
.filter-container {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    justify-content: center;
}
.filter-container {
    display: flex;
    align-items: center;
    justify-content:between; /* CƒÉn c√°c ph·∫ßn t·ª≠ ƒë·ªÅu nhau */
    gap: 10px;
}
.filter-box {
    width: 220px;
    height: 40px;
    font-size: 14px;
    background: linear-gradient(45deg, #444444, #222222);
    color: white;
    border: 2px solid #555555;
    padding: 5px 10px;
    border-radius: 6px;
    outline: none;
    transition: all 0.3s ease-in-out;
}
#reloadData {
    float: right; /* ƒê∆∞a n√∫t v·ªÅ g√≥c ph·∫£i */
    padding: 10px 20px;
    font-size: 15px;
    font-weight: bold;
    color: black;
    background: linear-gradient(45deg, #444444, #222222); /* V√†ng cam */
    border: #666666;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease-in-out;
}
/* ƒê·ªïi m√†u n·ªÅn c·ªßa b·∫£ng */
.table-dark {
    background-color: rgba(169, 169, 169, 0.5); /* M√†u x√°m ƒë·∫≠m, ƒë·ªô trong su·ªët nh·∫π */
    color: white; /* Ch·ªØ m√†u tr·∫Øng */
}

/* M√†u n·ªÅn c·ªßa h√†ng trong b·∫£ng */
.table-dark tbody tr {
    background-color: rgba(50, 50, 50, 0.9); /* X√°m trung b√¨nh */
}


/* Khi hover v√†o h√†ng */
.table-dark tbody tr:hover {
    background-color: rgba(255, 204, 0, 0.2) !important; /* N·ªÅn v√†ng nh·∫°t khi r√™ chu·ªôt */
    color: white;
    transform: scale(1.01); /* Hi·ªáu ·ª©ng ph√≥ng to nh·∫π */
}

.count-orders {
    text-align: right; /* CƒÉn ph·∫£i */
    font-family: "Times New Roman", serif; /* ƒê·ªïi font */
    font-size: 14px;
    font-style: italic; /* Ch·ªØ nghi√™ng */
    font-weight: normal; /* Kh√¥ng in ƒë·∫≠m */
    color: #FFFFFF;
    margin-bottom: 5px;
}

.highlight-vin {
    color: #FF3300 !important; /* Ch·ªØ m√†u ƒë·ªè ƒë·∫≠m */
    font-weight: bold;
    font-size: 12px; /* Ph√≥ng to ch·ªØ */
    padding: 10px; /* C√°ch ƒë·ªÅu n·ªôi dung */
    text-align: center;
}
#reloadData:hover {
    background: linear-gradient(45deg, #444444, #222222); /* Cam ƒë·∫≠m h∆°n */
    color: white;
}

.search-box {
    width: 200px; /* Gi·∫£m chi·ªÅu r·ªông */
    height: 40px; /* Gi·∫£m chi·ªÅu cao */
    font-size: 14px; /* Gi·∫£m k√≠ch th∆∞·ªõc ch·ªØ */
    background: linear-gradient(45deg, #444444, #222222);
    color: #ffcc00; /* Ch·ªØ m√†u v√†ng n·ªïi b·∫≠t */
   border: 2px solid #555555; /* Vi·ªÅn v√†ng */
    padding: 5px 10px; /* Thu nh·ªè padding */
    border-radius: 6px; /* Bo g√≥c nh·∫π */
    outline: none;
    transition: all 0.3s ease-in-out;
}
.search-box::placeholder {
    color: rgba(255, 255, 255, 0.9); /* M√†u tr·∫Øng nh·∫°t */
    font-style: arial;
}
.loading {
    display: none;
    width: 100%;
    text-align: center;
    font-size: 15px;
    color: white;
    background: rgba(54, 54, 54, 0);
    padding: 12px;
    border-radius: 8px;
    animation: fadeIn 0.5s ease-in-out;
}
.highlight {
    background-color: yellow;
    color: black;
    font-weight: bold;
}

/* Th√™m hi·ªáu ·ª©ng spinner */
.loading::before {
    content: "‚è≥";
    font-weight: bold;
    animation: pulse 1s infinite alternate;
}

@keyframes pulse {
    0% { opacity: 0.6; }
    100% { opacity: 1; }
}
th {
    cursor: pointer; /* Hi·ªÉn th·ªã con tr·ªè khi hover */
    user-select: none; /* NgƒÉn ch·ªçn vƒÉn b·∫£n khi nh·∫•n */
    position: relative;
    padding-right: 20px; /* D√†nh ch·ªó cho bi·ªÉu t∆∞·ª£ng */
}

/* Bi·ªÉu t∆∞·ª£ng s·∫Øp x·∫øp */
th::after {
    content: " ‚¨ç"; /* M≈©i t√™n l√™n xu·ªëng m·∫∑c ƒë·ªãnh */
    font-size: 12px;
    color: #aaa;
    position: absolute;
    right: 5px;
}

/* Khi s·∫Øp x·∫øp tƒÉng d·∫ßn */
th.sorted-asc::after {
    content: " ‚ñ≤";
    color: #ffcc00;
}

/* Khi s·∫Øp x·∫øp gi·∫£m d·∫ßn */
th.sorted-desc::after {
    content: " ‚ñº";
    color: #ffcc00;
}

    </style>

<style>
/* C·ªë ƒë·ªãnh ti√™u ƒë·ªÅ b·∫£ng */
.table-responsive {
    position: relative;
    overflow: auto;
    max-height: 500px; /* Gi·ªØ nguy√™n gi·ªõi h·∫°n chi·ªÅu cao */
}

.table thead th {
    position: sticky;
    top: 0;
    background: linear-gradient(45deg, #444444, #222222); /* Gi·ªØ n·ªÅn ti√™u ƒë·ªÅ */
    z-index: 100;
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng cho s·ªë VIN */
@keyframes glow {
    0% { text-shadow: 0 0 5px red; }
    50% { text-shadow: 0 0 15px red; }
    100% { text-shadow: 0 0 5px red; }
}

.highlight-vin {
    color: red !important;
    font-weight: bold;
    animation: glow 1.5s infinite alternate;
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng cho s·ªë VIN v·ªõi m√†u v√†ng */
@keyframes glowYellow {
    0% { text-shadow: 0 0 5px yellow; }
    50% { text-shadow: 0 0 15px yellow; }
    100% { text-shadow: 0 0 5px yellow; }
}

.highlight-vin {
    color: yellow !important;
    font-weight: bold;
    animation: glowYellow 1.5s infinite alternate;
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng cho s·ªë VIN v·ªõi m√†u v√†ng v√† k√≠ch th∆∞·ªõc l·ªõn h∆°n */
@keyframes glowYellow {
    0% { text-shadow: 0 0 5px yellow; }
    50% { text-shadow: 0 0 15px yellow; }
    100% { text-shadow: 0 0 5px yellow; }
}

.highlight-vin {
    color: yellow !important;
    font-weight: bold;
    font-size: 18px !important; /* TƒÉng k√≠ch th∆∞·ªõc ch·ªØ */
    animation: glowYellow 1.5s infinite alternate;
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng sang tr·ªçng v·ªõi m√†u v√†ng gold */
@keyframes glowGold {
    0% { text-shadow: 0 0 5px gold; }
    50% { text-shadow: 0 0 15px gold; }
    100% { text-shadow: 0 0 5px gold; }
}

.highlight-vin {
    color: gold !important;
    font-weight: bold;
    font-size: 20px !important; /* TƒÉng k√≠ch th∆∞·ªõc ch·ªØ h∆°n n·ªØa */
    animation: glowGold 1.5s infinite alternate;
    text-transform: uppercase; /* In hoa ƒë·ªÉ tƒÉng ƒë·ªô sang tr·ªçng */
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng sang tr·ªçng v·ªõi m√†u b·∫°c s√°ng */
@keyframes glowSilver {
    0% { text-shadow: 0 0 5px silver; }
    50% { text-shadow: 0 0 15px silver; }
    100% { text-shadow: 0 0 5px silver; }
}

.highlight-vin {
    color: silver !important;
    font-weight: bold;
    font-size: 20px !important; /* K√≠ch th∆∞·ªõc l·ªõn h∆°n ƒë·ªÉ n·ªïi b·∫≠t */
    animation: glowSilver 1.5s infinite alternate;
    text-transform: uppercase; /* In hoa ƒë·ªÉ tƒÉng ƒë·ªô sang tr·ªçng */
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng nh·∫π v·ªõi m√†u b·∫°c g·ªëc */
@keyframes glowSilverLight {
    0% { text-shadow: 0 0 3px silver; }
    50% { text-shadow: 0 0 3px silver; }
    100% { text-shadow: 0 0 3px silver; }
}

.highlight-vin {
    color: silver !important; /* Gi·ªØ m√†u b·∫°c g·ªëc */
    font-weight: bold;
    font-size: 14px !important; /* K√≠ch th∆∞·ªõc v·ª´a ph·∫£i */
    animation: glowSilverLight 1.5s infinite alternate;
    text-transform: uppercase; /* In hoa ƒë·ªÉ d·ªÖ nh√¨n h∆°n */
}
</style>


<style>
/* Hi·ªáu ·ª©ng ph√°t s√°ng nh·∫π v·ªõi m√†u b·∫°c g·ªëc */
@keyframes glowSilverLight {
    0% { text-shadow: 0 0 3px silver; }
    50% { text-shadow: 0 0 10px silver; }
    100% { text-shadow: 0 0 3px silver; }
}

.highlight-vin {
    color: silver !important; /* Gi·ªØ m√†u b·∫°c g·ªëc */
    font-weight: bold;
    font-size: 14px !important; /* K√≠ch th∆∞·ªõc ch·ªØ v·ª´a ph·∫£i */
    animation: glowSilverLight 1.5s infinite alternate;
    text-transform: uppercase; /* In hoa ƒë·ªÉ tƒÉng ƒë·ªô n·ªïi b·∫≠t */
}
</style>

</head>
<body>
    <div class="container">
        <div class="header text-center text-white py-3">
            üìã DANH S√ÅCH ƒê∆†N H√ÄNG BAÃÅN XE üöó
        </div>

        <ul class="nav nav-tabs" id="myTabs">
            <li class="nav-item">
                <a class="nav-link active" id="tab1-tab" data-bs-toggle="tab" href="#tab1">ƒê√É GH√âP</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="tab2-tab" data-bs-toggle="tab" href="#tab2">CH∆ØA GH√âP</a>
            </li>

        </ul>
        <div class="tab-content mt-1">
            <div class="loading" id="loading">Loading...</div>
            <div class="tab-pane fade show active" id="tab1">
                <input type="text" id="search1" class="form-control search-box" placeholder="üîç T√¨m ki·∫øm...">
<div class="filter-container">
    <select id="filter-tuvan" class="form-control filter-box">
        <option value="">ChoÃ£n T∆∞ V√¢ÃÅn BH</option>
      <option value="ƒêinh TroÃ£ng Nh√¢n">ƒêinh TroÃ£ng Nh√¢n</option>
    <option value="L√™ Mai Anh">L√™ Mai Anh</option>
    <option value="L√™ Qu·ªëc Th·ªãnh">L√™ Qu·ªëc Th·ªãnh</option>
    <option value="L∆∞∆°ng Th·∫ø Ng·ªçc">L∆∞∆°ng Th·∫ø Ng·ªçc</option>
    <option value="Nguy·ªÖn Ho√†ng Ph√∫c">Nguy·ªÖn Ho√†ng Ph√∫c</option>
    <option value="Nguy·ªÖn Minh Trung">Nguy·ªÖn Minh Trung</option>
    <option value="Nguy·ªÖn Thi·ªán Th·∫£o">Nguy·ªÖn Thi·ªán Th·∫£o</option>
    <option value="T·∫•t B√°ch T∆∞·ªùng">T·∫•t B√°ch T∆∞·ªùng</option>
    <option value="Th√†nh Ng·ªçc Vinh">Th√†nh Ng·ªçc Vinh</option>
    <option value="V√µ Minh Tu·∫•n">V√µ Minh Tu·∫•n</option>
    <option value="Tr·∫ßn Th·ªã Nguy·ªát B·∫°ch">Tr·∫ßn Th·ªã Nguy·ªát B·∫°ch</option>
    <option value="Ph·∫°m Tr·ªçng Huy">Ph·∫°m Tr·ªçng Huy</option>
    <option value="Nguy·ªÖn Anh Tu·∫•n">Nguy·ªÖn Anh Tu·∫•n</option>
    <option value="Nguy·ªÖn Tr·∫ßn Ho√†ng Thanh">Nguy·ªÖn Tr·∫ßn Ho√†ng Thanh</option>
    <option value="Nguy·ªÖn Ho√†ng Th·∫°ch">Nguy·ªÖn Ho√†ng Th·∫°ch</option>
    <option value="L√Ω Kim Vinh">L√Ω Kim Vinh</option>
    <option value="B√πi Anh T√†i">B√πi Anh T√†i</option>
    <option value="V≈© Th·ªã Trang">V≈© Th·ªã Trang</option>
    </select>
    <select id="filter-dongxe" class="form-control filter-box">
        <option value="">ChoÃ£n DoÃÄng Xe</option>
          <option value="VF3">VF3</option>
    <option value="VF5">VF5</option>
    <option value="VF6">VF6</option>
    <option value="VF7">VF7</option>
    <option value="VF8">VF8</option>
    <option value="VF9">VF9</option>
    </select>
<button id="reloadData" class="btn btn-warning">üîÑ T·∫£i l·∫°i d·ªØ li·ªáu</button></div><p id="count1" class="count-orders">T√¥Ãâng ƒê∆°n: 0</p>
                <div class="table-responsive">
                    <table class="table table-dark table-bordered text-center" id="table1">
<thead>
    <tr>
        <th onclick="sortTable(0)">S·ªê TT</th>
        <th onclick="sortTable(1)">T∆Ø V·∫§N BH</th>
        <th onclick="sortTable(2)">D√íNG XE</th>
        <th onclick="sortTable(3)">MODEL</th>
        <th onclick="sortTable(4)">NGO·∫†I TH·∫§T</th>
        <th onclick="sortTable(5)">N·ªòI TH·∫§T</th>
        <th onclick="sortTable(6)">S·ªê ƒê∆†N H√ÄNG (VSO)</th>
        <th onclick="sortTable(7)">T√äN KH√ÅCH H√ÄNG</th>
        <th onclick="sortTable(8)">S·ªê VIN</th>
        <th onclick="sortTable(9)">NG√ÄY GH√âP</th>
        <th onclick="sortTable(10)">S·ªê NG√ÄY</th>
        <th onclick="sortTable(11)">V·ªä TR√ç XE</th>
    </tr>
</thead>

                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane fade" id="tab2">
                <input type="text" id="search2" class="form-control search-box" placeholder="üîç T√¨m ki·∫øm..."><div class="filter-container">
    <select id="filter-dongxe2" class="form-control filter-box">
        <option value="">Ch·ªçn D√≤ng Xe</option>
        <option value="VF3">VF3</option>
        <option value="VF5">VF5</option>
        <option value="VF6">VF6</option>
        <option value="VF7">VF7</option>
        <option value="VF8">VF8</option>
        <option value="VF9">VF9</option>
    </select>
</div>
<p id="count2" class="count-orders">T√¥Ãâng ƒê∆°n: 0</p>
                <div class="table-responsive">
                    <table class="table table-dark table-bordered text-center" id="table2">
                        <thead>
                            <tr>
                                <th>S·ªê TT</th>
                                <th>T∆Ø V·∫§N BH</th>
                                <th>D√íNG XE</th>
                                <th>MODEL</th>
                                <th>NGO·∫†I TH·∫§T</th>
                                <th>N·ªòI TH·∫§T</th>
                                <th>S√îÃÅ ƒê∆†N HAÃÄNG (VSO)</th>
                                <th>T√äN KH√ÅCH H√ÄNG</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
<script>
     if (sessionStorage.getItem('loggedIn') !== 'true') {
        window.location.href = "dang-nhap.html";
    }
let tableData = {
    table1: [],
    table2: []
};

// Fetch d·ªØ li·ªáu t·ª´ API v√† hi·ªÉn th·ªã b·∫£ng
function fetchData() {
    const loadingElement = document.getElementById("loading");
    loadingElement.style.display = "block";

    const apiURL = "https://script.google.com/macros/s/AKfycbyT5ODh1u0mbxbh6flo1vb5-7dPff6w9zrvFoCfXlqBRCscfLT0J79zVrpqziMqqTfR/exec";

    axios.get(apiURL)
        .then(response => {
            let data = response.data;
            if (data.Sheet1) {
                tableData.table1 = data.Sheet1.map(row => Object.values(row));
                renderTable(tableData.table1, "table1");
            }
            if (data.Sheet2) {
                tableData.table2 = data.Sheet2.map(row => Object.values(row));
                renderTable(tableData.table2, "table2");
            }
        })
        .catch(error => {
            console.error("L·ªói t·∫£i d·ªØ li·ªáu:", error);
            loadingElement.innerHTML = `<div class="text-danger">‚ùå Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu, vui l√≤ng th·ª≠ l·∫°i!</div>`;
        })
        .finally(() => {
            setTimeout(() => {
                loadingElement.style.display = "none";
            }, 1000);
        });
}

// Render b·∫£ng t·ª´ d·ªØ li·ªáu
function renderTable(data, tableId) {
    let tableBody = document.querySelector(`#${tableId} tbody`);
    tableBody.innerHTML = "";

    let fragment = document.createDocumentFragment();
    data.forEach((row, index) => {
        let tr = document.createElement("tr");
        tr.innerHTML = `<td>${index + 1}</td>` + row.map(cell => `<td>${cell || ""}</td>`).join("");
        fragment.appendChild(tr);
    });

    tableBody.appendChild(fragment);
    updateCount(tableId);
}

// X√≥a d·∫•u ti·∫øng Vi·ªát ƒë·ªÉ t√¨m ki·∫øm v√† l·ªçc kh√¥ng ph√¢n bi·ªát d·∫•u
function removeAccents(str) {
    return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().trim();
}

// C·∫≠p nh·∫≠t t·ªïng s·ªë ƒë∆°n hi·ªÉn th·ªã
function updateCount(tableId) {
    let visibleRows = document.querySelectorAll(`#${tableId} tbody tr:not([style*='display: none'])`).length;
    document.getElementById(`count${tableId === "table1" ? "1" : "2"}`).textContent = `T·ªïng ƒê∆°n: ${visibleRows}`;
}

// **S·∫Øp x·∫øp b·∫£ng theo c·ªôt**
let sortDirection = {};

function sortTable(columnIndex, tableId) {
    if (!tableData[tableId] || tableData[tableId].length === 0) return;

    sortDirection[tableId] = sortDirection[tableId] || {};
    sortDirection[tableId][columnIndex] = !sortDirection[tableId][columnIndex] ? 1 : -sortDirection[tableId][columnIndex];

    let sortedData = [...tableData[tableId]];
    sortedData.sort((rowA, rowB) => {
        let cellA = rowA[columnIndex] ? rowA[columnIndex].toString().trim() : "";
        let cellB = rowB[columnIndex] ? rowB[columnIndex].toString().trim() : "";

        let isNumeric = !isNaN(cellA) && !isNaN(cellB);
        let isDate = !isNaN(Date.parse(cellA)) && !isNaN(Date.parse(cellB));

        if (isNumeric) {
            return (parseFloat(cellA) - parseFloat(cellB)) * sortDirection[tableId][columnIndex];
        }
        if (isDate) {
            return (new Date(cellA) - new Date(cellB)) * sortDirection[tableId][columnIndex];
        }
        return cellA.localeCompare(cellB, "vi", { numeric: true }) * sortDirection[tableId][columnIndex];
    });

    tableData[tableId] = sortedData;
    renderTable(sortedData, tableId);
}


// H√†m highlight v√† t√¨m ki·∫øm
function highlightSearch(tableId, searchValue) {
    let rows = document.querySelectorAll(`#${tableId} tbody tr`);
    let regex = new RegExp(`(${searchValue})`, "gi");

    rows.forEach(row => {
        let showRow = false;

        row.querySelectorAll("td").forEach(td => {
            let text = td.textContent.toLowerCase();
            let searchLower = searchValue.toLowerCase();

            // L∆∞u n·ªôi dung g·ªëc n·∫øu ch∆∞a c√≥
            if (!td.hasAttribute("data-original-text")) {
                td.setAttribute("data-original-text", td.innerHTML);
            }

            if (text.includes(searchLower)) {
                showRow = true;
                td.innerHTML = td.getAttribute("data-original-text").replace(regex, `<span class="highlight">$1</span>`);
            } else {
                td.innerHTML = td.getAttribute("data-original-text"); // Tr·∫£ l·∫°i n·ªôi dung g·ªëc n·∫øu kh√¥ng kh·ªõp
            }
        });

        row.style.display = showRow ? "" : "none"; // ·∫®n c√°c d√≤ng kh√¥ng ch·ª©a t·ª´ kh√≥a
    });

    updateCount(tableId);
}

// H√†m x√≥a highlight v√† hi·ªÉn th·ªã l·∫°i d·ªØ li·ªáu g·ªëc
function removeHighlight(tableId) {
    let rows = document.querySelectorAll(`#${tableId} tbody tr`);

    rows.forEach(row => {
        row.style.display = ""; // Hi·ªÉn th·ªã l·∫°i t·∫•t c·∫£ h√†ng

        row.querySelectorAll("td").forEach(td => {
            if (td.hasAttribute("data-original-text")) {
                td.innerHTML = td.getAttribute("data-original-text"); // Kh√¥i ph·ª•c n·ªôi dung g·ªëc
                td.removeAttribute("data-original-text"); // X√≥a d·ªØ li·ªáu t·∫°m
            }
        });
    });

    updateCount(tableId);
}

// Thi·∫øt l·∫≠p t√¨m ki·∫øm v·ªõi highlight
function setupSearch(inputId, tableId) {
    document.getElementById(inputId).addEventListener("input", function () {
        let searchValue = this.value.trim();
        if (searchValue === "") {
            removeHighlight(tableId);
        } else {
            highlightSearch(tableId, searchValue);
        }
    });
}

function setupSearch(inputId, tableId) {
    document.getElementById(inputId).addEventListener("input", function () {
        let searchValue = this.value.trim();
        if (searchValue === "") {
            removeHighlight(tableId);
        } else {
            highlightSearch(tableId, searchValue);
        }
    });
}

// **L·ªçc d·ªØ li·ªáu theo d√≤ng xe v√† t∆∞ v·∫•n BH cho Tab 1**
function filterTable(tableId) {
    let tuVanValue = removeAccents(document.getElementById("filter-tuvan").value);
    let dongXeValue = removeAccents(document.getElementById("filter-dongxe").value);

    let rows = document.querySelectorAll(`#${tableId} tbody tr`);
    rows.forEach(row => {
        let tuVanText = removeAccents(row.cells[1]?.textContent || "");
        let dongXeText = removeAccents(row.cells[2]?.textContent || "");

        let matchTuVan = !tuVanValue || tuVanText.includes(tuVanValue);
        let matchDongXe = !dongXeValue || dongXeText.includes(dongXeValue);

        row.style.display = matchTuVan && matchDongXe ? "" : "none";
    });

    updateCount(tableId);
}

// **L·ªçc d·ªØ li·ªáu theo d√≤ng xe cho Tab 2**
function filterTable2() {
    let dongXeValue = removeAccents(document.getElementById("filter-dongxe2").value);
    let rows = document.querySelectorAll("#table2 tbody tr");

    rows.forEach(row => {
        let dongXeText = removeAccents(row.cells[2]?.textContent || "");
        row.style.display = !dongXeValue || dongXeText.includes(dongXeValue) ? "" : "none";
    });

    updateCount("table2");
}

// **G√°n s·ª± ki·ªán khi ch·ªçn l·ªçc d·ªØ li·ªáu, t√¨m ki·∫øm, s·∫Øp x·∫øp v√† t·∫£i l·∫°i**
document.addEventListener("DOMContentLoaded", function () {
    fetchData();

    setupSearch("search1", "table1");
    setupSearch("search2", "table2");

    document.getElementById("filter-tuvan").addEventListener("change", function () {
        filterTable("table1");
    });
    document.getElementById("filter-dongxe").addEventListener("change", function () {
        filterTable("table1");
    });
    document.getElementById("filter-dongxe2").addEventListener("change", function () {
        filterTable2();
    });

    document.querySelectorAll("#table1 th").forEach((th, index) => {
        th.addEventListener("click", function () {
            sortTable(index, "table1");
        });
    });
    document.querySelectorAll("#table2 th").forEach((th, index) => {
        th.addEventListener("click", function () {
            sortTable(index, "table2");
        });
    });
function showNotification(message) {
    let notification = document.createElement("div");
    notification.textContent = message;
    notification.style.position = "fixed";
    notification.style.top = "20px";
    notification.style.right = "20px";
    notification.style.background = "#28a745";
    notification.style.color = "white";
    notification.style.padding = "10px";
    notification.style.borderRadius = "5px";
    notification.style.zIndex = "1000";

    document.body.appendChild(notification);
    
    setTimeout(() => {
        document.body.removeChild(notification);
    }, 3000);
}
function removeHighlight(tableId) {
    let rows = document.querySelectorAll(`#${tableId} tbody tr`);
    
    rows.forEach(row => {
        row.style.display = ""; // Hi·ªÉn th·ªã l·∫°i t·∫•t c·∫£ h√†ng
        
        row.querySelectorAll("td").forEach(td => {
            if (td.dataset.originalText) {
                td.innerHTML = td.dataset.originalText; // Kh√¥i ph·ª•c n·ªôi dung g·ªëc
                delete td.dataset.originalText; // X√≥a d·ªØ li·ªáu l∆∞u tr·ªØ
            }
        });
    });

    updateCount(tableId);
}

document.getElementById("reloadData").addEventListener("click", function () {
    showNotification("üîÑ ƒêang t·∫£i l·∫°i d·ªØ li·ªáu...");
    fetchData();
});

    document.getElementById("reloadData").addEventListener("click", function () {
        fetchData();
    });
});

</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    function fetchData() {
        const loadingElement = document.getElementById("loading");
        loadingElement.style.display = "block";

        const apiURL = "https://script.google.com/macros/s/AKfycbyT5ODh1u0mbxbh6flo1vb5-7dPff6w9zrvFoCfXlqBRCscfLT0J79zVrpqziMqqTfR/exec";

        axios.get(apiURL)
            .then(response => {
                let data = response.data;
                if (data.Sheet1) {
                    tableData.table1 = data.Sheet1.map(row => Object.values(row));
                    renderTable(tableData.table1, "table1");
                    highlightVinNumbers(); // G·ªçi ngay sau khi b·∫£ng hi·ªÉn th·ªã
                }
                if (data.Sheet2) {
                    tableData.table2 = data.Sheet2.map(row => Object.values(row));
                    renderTable(tableData.table2, "table2");
                }
            })
            .catch(error => {
                console.error("L·ªói t·∫£i d·ªØ li·ªáu:", error);
                loadingElement.innerHTML = `<div class="text-danger">‚ùå Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu, vui l√≤ng th·ª≠ l·∫°i!</div>`;
            })
            .finally(() => {
                setTimeout(() => {
                    loadingElement.style.display = "none";
                }, 1000);
            });
    }

    function highlightVinNumbers() {
        let tableRows = document.querySelectorAll("#table1 tbody tr");

        tableRows.forEach(row => {
            let vinCell = row.cells[8]; // C·ªôt "S·ªê VIN"
            if (vinCell && vinCell.textContent.trim() !== "") {
                vinCell.classList.add("highlight-vin");
            }
        });
    }

    document.getElementById("reloadData").addEventListener("click", function () {
        fetchData();
    });

    // CSS ch·ªâ l√†m n·ªïi b·∫≠t ch·ªØ VIN, kh√¥ng thay ƒë·ªïi n·ªÅn
    let style = document.createElement("style");
    style.innerHTML = `
        .highlight-vin {
            color: red !important;
            font-weight: bold;
        }
    `;
    document.head.appendChild(style);

    fetchData(); // G·ªçi fetchData khi trang t·∫£i xong
});
</script>

</body>
</html>
